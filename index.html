<!doctype html>
<html lang="th">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Inter', 'Noto Sans Thai', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    html {
      height: 100%;
    }
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
    
    .progress-bar {
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .fade-in {
      animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .result-card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(10px);
    }
    
    .result-card:hover {
      transform: translateY(-4px) scale(1.01);
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }

    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    
    input[type="number"] {
      -moz-appearance: textfield;
    }

    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn-modern {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .btn-modern:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(102, 126, 234, 0.4);
    }

    .btn-modern:active {
      transform: translateY(0);
    }

    .input-modern {
      transition: all 0.3s ease;
      background: rgba(249, 250, 251, 0.8);
    }

    .input-modern:focus {
      background: white;
      transform: translateY(-1px);
      box-shadow: 0 8px 16px rgba(102, 126, 234, 0.15);
    }

    .status-badge {
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }

    .animate-pulse-slow {
      animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    .gradient-text {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="min-h-full">
  <main class="min-h-full relative overflow-hidden" style="background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);"><!-- Animated Background Elements -->
   <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-20 left-10 w-72 h-72 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse-slow"></div>
    <div class="absolute top-40 right-10 w-72 h-72 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse-slow" style="animation-delay: 1s;"></div>
    <div class="absolute -bottom-20 left-1/2 w-72 h-72 bg-indigo-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse-slow" style="animation-delay: 2s;"></div>
   </div>
   <div class="min-h-full flex items-center justify-center p-4 relative z-10">
    <div class="w-full max-w-2xl"><!-- Progress Bar -->
     <div id="progressContainer" class="mb-8 hidden">
      <div class="flex justify-between items-center mb-2"><span class="text-white text-sm font-medium opacity-80">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</span> <span id="progressText" class="text-white text-sm font-bold">0%</span>
      </div>
      <div class="bg-white bg-opacity-10 rounded-full h-2 overflow-hidden backdrop-blur-sm">
       <div id="progressBar" class="progress-bar h-2 rounded-full" style="width: 0%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);"></div>
      </div>
     </div><!-- Content Container -->
     <div id="contentContainer" class="glass-card rounded-3xl shadow-2xl p-10 fade-in"><!-- Welcome Screen -->
      <div id="welcomeScreen">
       <div class="text-center">
        <div class="inline-block p-6 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-3xl mb-6 shadow-2xl">
         <div class="text-6xl">
          üí∞
         </div>
        </div>
        <h1 id="mainTitle" class="text-5xl font-extrabold mb-4 gradient-text leading-tight">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h1>
        <p id="subtitle" class="text-gray-500 mb-10 text-lg font-medium max-w-md mx-auto">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</p><button onclick="startAssessment()" class="btn-modern px-10 py-5 text-white font-bold rounded-2xl text-lg shadow-xl" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"> <span class="flex items-center justify-center gap-2"> <span>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</span> <span class="text-xl">‚Üí</span> </span> </button>
       </div>
      </div><!-- Question Screens -->
      <div id="questionScreen" class="hidden">
       <div id="questionContent"></div>
      </div><!-- Results Screen -->
      <div id="resultsScreen" class="hidden">
       <div class="text-center mb-8">
        <div class="text-5xl mb-4">
         üìä
        </div>
        <h2 class="text-3xl font-bold mb-2" style="color: #667eea;">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h2>
       </div>
       <div id="resultsContent"></div>
      </div><!-- Attitude Test Screen -->
      <div id="attitudeScreen" class="hidden">
       <div id="attitudeContent"></div>
      </div><!-- Final Results Screen -->
      <div id="finalScreen" class="hidden">
       <div class="text-center mb-8">
        <div class="text-5xl mb-4">
         üéØ
        </div>
        <h2 class="text-3xl font-bold mb-2" style="color: #667eea;">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h2>
       </div>
       <div id="finalContent"></div>
      </div>
     </div>
    </div>
   </div>
  </main>
  <script>
    const defaultConfig = {
      main_title: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô",
      subtitle: "‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°",
      primary_color: "#667eea",
      secondary_color: "#764ba2",
      background_color: "#ffffff",
      text_color: "#333333",
      success_color: "#10b981"
    };

    let currentStep = 0;
    let userData = {
      income: 0,
      debtExpense: 0,
      expenses: {},
      savings: 0,
      attitudeAnswers: []
    };

    const expenseCategories = [
      { key: 'food', label: '‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£', icon: 'üçú' },
      { key: 'transport', label: '‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á/‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô', icon: 'üöó' },
      { key: 'household', label: '‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô', icon: 'üè†' },
      { key: 'utilities', label: '‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥/‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü', icon: 'üí°' },
      { key: 'entertainment', label: '‡∏Ñ‡πà‡∏≤‡∏ô‡∏±‡∏ô‡∏ó‡∏ô‡∏≤‡∏Å‡∏≤‡∏£/‡∏™‡∏±‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå', icon: 'üéâ' },
      { key: 'clothing', label: '‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤/‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö', icon: 'üëî' },
      { key: 'internet', label: '‡∏Ñ‡πà‡∏≤‡πÄ‡∏ô‡πá‡∏ï/‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå', icon: 'üì±' },
      { key: 'other', label: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', icon: 'üìù' }
    ];

    const attitudeQuestions = [
      {
        question: '‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏£‡∏Å?',
        options: [
          { text: '‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á', correct: true },
          { text: '‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏Å‡πà‡∏≠‡∏ô', correct: false },
          { text: '‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏≠‡∏≠‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠', correct: false }
        ],
        explanation: '‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠ "‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á" ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏´‡∏≤‡∏Å‡∏≠‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏°‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô ‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ "‡∏à‡πà‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô" (Pay Yourself First) ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏≠‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏≠‡∏≠‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏≠‡∏°‡πÄ‡∏•‡∏¢'
      },
      {
        question: '‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
        options: [
          { text: '‡∏°‡∏µ‡πÅ‡∏ú‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥', correct: true },
          { text: '‡∏°‡∏µ‡πÅ‡∏ú‡∏ô‡∏Ñ‡∏£‡πà‡∏≤‡∏ß‡πÜ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á', correct: false },
          { text: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏ô ‡πÉ‡∏ä‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÑ‡∏õ‡∏ß‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô', correct: false }
        ],
        explanation: '‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠ "‡∏°‡∏µ‡πÅ‡∏ú‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥" ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏£‡∏•‡∏∏‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á'
      },
      {
        question: '‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡πÇ‡∏ö‡∏ô‡∏±‡∏™/‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç) ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?',
        options: [
          { text: '‡∏ô‡∏≥‡πÑ‡∏õ‡∏≠‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà', correct: true },
          { text: '‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏ô‡∏≤‡∏ô', correct: false },
          { text: '‡πÅ‡∏ö‡πà‡∏á‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ ‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏≠‡∏≠‡∏°', correct: false }
        ],
        explanation: '‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠ "‡∏ô‡∏≥‡πÑ‡∏õ‡∏≠‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà" ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏î‡∏µ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡∏≠‡∏≠‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 70-80% ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á'
      },
      {
        question: '‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö-‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
        options: [
          { text: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥', correct: true },
          { text: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ö‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏≤‡∏ß', correct: false },
          { text: '‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡∏à‡∏≥‡∏Ñ‡∏£‡πà‡∏≤‡∏ß‡πÜ ‡πÉ‡∏ô‡πÉ‡∏à', correct: false }
        ],
        explanation: '‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠ "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥" ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏õ‡πÑ‡∏´‡∏ô‡∏ö‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ ‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á ‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û'
      },
      {
        question: '‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤/‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?',
        options: [
          { text: '‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ß‡πà‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏ã‡∏∑‡πâ‡∏≠', correct: true },
          { text: '‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å', correct: false },
          { text: '‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô ‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï', correct: false }
        ],
        explanation: '‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠ "‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ß‡πà‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏ã‡∏∑‡πâ‡∏≠" ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏°‡∏≠‡πÑ‡∏õ ‡∏´‡∏≤‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏°‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Å‡πá‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏á‡πÑ‡∏ß‡πâ'
      }
    ];

    const questions = [
      {
        id: 'income',
        title: '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
        icon: 'üíµ',
        description: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
        type: 'single',
        field: 'income'
      },
      {
        id: 'debt',
        title: '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
        icon: 'üí≥',
        description: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏ä‡∏≥‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
        type: 'single',
        field: 'debtExpense'
      },
      {
        id: 'expenses',
        title: '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô',
        icon: 'üõí',
        description: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏°‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
        type: 'multiple',
        field: 'expenses'
      },
      {
        id: 'savings',
        title: '‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏°‡∏£‡∏ß‡∏°‡πÉ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô',
        icon: 'üè¶',
        description: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡πÉ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô',
        type: 'single',
        field: 'savings'
      }
    ];

    function startAssessment() {
      document.getElementById('welcomeScreen').classList.add('hidden');
      document.getElementById('progressContainer').classList.remove('hidden');
      currentStep = 0;
      showQuestion();
    }

    function showQuestion() {
      const questionScreen = document.getElementById('questionScreen');
      const questionContent = document.getElementById('questionContent');
      questionScreen.classList.remove('hidden');
      
      const question = questions[currentStep];
      const progress = ((currentStep + 1) / questions.length) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      document.getElementById('progressText').textContent = Math.round(progress) + '%';

      if (question.type === 'single') {
        questionContent.innerHTML = `
          <div class="text-center mb-8">
            <div class="inline-block p-5 bg-gradient-to-br from-purple-100 to-indigo-100 rounded-2xl mb-5">
              <div class="text-5xl">${question.icon}</div>
            </div>
            <h2 class="text-3xl font-bold mb-3 text-gray-800">${question.title}</h2>
            <p class="text-gray-500 font-medium">${question.description}</p>
          </div>
          <div class="mb-8">
            <label for="inputField" class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
            <input type="number" id="inputField" class="input-modern w-full px-6 py-4 border-0 rounded-2xl focus:outline-none text-xl font-semibold text-gray-800" placeholder="0" min="0" step="0.01">
          </div>
          <div class="flex gap-3">
            ${currentStep > 0 ? '<button onclick="previousQuestion()" class="flex-1 px-6 py-4 bg-gray-100 text-gray-700 font-bold rounded-2xl hover:bg-gray-200 transition-all">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>' : ''}
            <button onclick="nextQuestion()" class="btn-modern flex-1 px-6 py-4 text-white font-bold rounded-2xl shadow-lg" style="background: linear-gradient(135deg, ${defaultConfig.primary_color} 0%, ${defaultConfig.secondary_color} 100%);">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
          </div>
        `;
      } else if (question.type === 'multiple') {
        let expenseInputs = expenseCategories.map(cat => `
          <div class="mb-3">
            <label for="expense_${cat.key}" class="block text-sm font-bold mb-2 text-gray-700 flex items-center gap-2">
              <span class="text-2xl">${cat.icon}</span>
              <span>${cat.label}</span>
            </label>
            <input type="number" id="expense_${cat.key}" class="input-modern w-full px-5 py-3 border-0 rounded-xl focus:outline-none text-lg font-semibold text-gray-800" placeholder="0" min="0" step="0.01" value="${userData.expenses[cat.key] || 0}">
          </div>
        `).join('');

        questionContent.innerHTML = `
          <div class="text-center mb-8">
            <div class="inline-block p-5 bg-gradient-to-br from-purple-100 to-indigo-100 rounded-2xl mb-5">
              <div class="text-5xl">${question.icon}</div>
            </div>
            <h2 class="text-3xl font-bold mb-3 text-gray-800">${question.title}</h2>
            <p class="text-gray-500 font-medium">${question.description}</p>
          </div>
          <div class="max-h-96 overflow-y-auto mb-8 pr-2 space-y-1">
            ${expenseInputs}
          </div>
          <div class="flex gap-3">
            <button onclick="previousQuestion()" class="flex-1 px-6 py-4 bg-gray-100 text-gray-700 font-bold rounded-2xl hover:bg-gray-200 transition-all">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            <button onclick="nextQuestion()" class="btn-modern flex-1 px-6 py-4 text-white font-bold rounded-2xl shadow-lg" style="background: linear-gradient(135deg, ${defaultConfig.primary_color} 0%, ${defaultConfig.secondary_color} 100%);">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
          </div>
        `;
      }
    }

    function nextQuestion() {
      const question = questions[currentStep];
      
      if (question.type === 'single') {
        const value = parseFloat(document.getElementById('inputField').value) || 0;
        if (value < 0) {
          showInlineMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
          return;
        }
        userData[question.field] = value;
      } else if (question.type === 'multiple') {
        expenseCategories.forEach(cat => {
          const value = parseFloat(document.getElementById(`expense_${cat.key}`).value) || 0;
          userData.expenses[cat.key] = value;
        });
      }

      currentStep++;
      
      if (currentStep < questions.length) {
        showQuestion();
      } else {
        showResults();
      }
    }

    function previousQuestion() {
      if (currentStep > 0) {
        currentStep--;
        showQuestion();
      }
    }

    function showInlineMessage(message) {
      const existingMsg = document.querySelector('.inline-message');
      if (existingMsg) existingMsg.remove();
      
      const msgDiv = document.createElement('div');
      msgDiv.className = 'inline-message bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-4';
      msgDiv.textContent = message;
      
      const questionContent = document.getElementById('questionContent');
      questionContent.insertBefore(msgDiv, questionContent.firstChild);
      
      setTimeout(() => msgDiv.remove(), 3000);
    }

    function showResults() {
      // Calculate and store results but don't show yet
      // Calculate DTI
      const dti = userData.income > 0 ? (userData.debtExpense / userData.income) * 100 : 0;
      let dtiStatus, dtiColor, dtiAdvice;
      
      if (dti <= 35) {
        dtiStatus = '‡∏î‡∏µ‡∏°‡∏≤‡∏Å';
        dtiColor = '#10b981';
        dtiAdvice = '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏ó‡∏∏‡∏ô';
      } else if (dti <= 45) {
        dtiStatus = '‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á';
        dtiColor = '#f59e0b';
        dtiAdvice = '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏£‡πÄ‡∏£‡πà‡∏á‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏´‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏î‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡πá‡∏ß';
      } else {
        dtiStatus = '‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢';
        dtiColor = '#ef4444';
        dtiAdvice = '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Ñ‡∏ß‡∏£‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÄ‡∏£‡πà‡∏á‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏´‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏î ‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏Å‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏ß‡∏Ñ‡∏ß‡∏£‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏µ‡πâ';
      }

      // Calculate Emergency Fund
      const totalMonthlyExpense = userData.debtExpense + Object.values(userData.expenses).reduce((a, b) => a + b, 0);
      const emergencyMonths = totalMonthlyExpense > 0 ? userData.savings / totalMonthlyExpense : 0;
      let efStatus, efColor, efAdvice;
      
      if (emergencyMonths < 3) {
        efStatus = '‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠';
        efColor = '#ef4444';
        const needed = (3 * totalMonthlyExpense) - userData.savings;
        efAdvice = `‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3-6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${needed.toLocaleString('th-TH', {maximumFractionDigits: 0})} ‡∏ö‡∏≤‡∏ó ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥`;
      } else if (emergencyMonths <= 6) {
        efStatus = '‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠';
        efColor = '#10b981';
        efAdvice = '‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ';
      } else {
        efStatus = '‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏õ‡πâ‡∏≤';
        efColor = '#3b82f6';
        const excess = userData.savings - (6 * totalMonthlyExpense);
        efAdvice = `‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${excess.toLocaleString('th-TH', {maximumFractionDigits: 0})} ‡∏ö‡∏≤‡∏ó) ‡πÑ‡∏õ‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏á‡∏≠‡∏Å‡πÄ‡∏á‡∏¢‡πÑ‡∏î‡πâ`;
      }

      // Calculate Liquidity
      const totalExpense = totalMonthlyExpense;
      const liquidity = userData.income - totalExpense;
      let liqStatus, liqColor, liqAdvice;
      
      if (liquidity < 0) {
        liqStatus = '‡∏ï‡∏¥‡∏î‡∏•‡∏ö';
        liqColor = '#ef4444';
        
        // Analyze expenses
        const expenseArray = Object.entries(userData.expenses).map(([key, value]) => ({
          key,
          value,
          label: expenseCategories.find(c => c.key === key)?.label || key
        })).sort((a, b) => b.value - a.value);
        
        const top3 = expenseArray.slice(0, 3).filter(e => e.value > 0);
        
        if (dti > 45) {
          liqAdvice = `‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏¥‡∏î‡∏•‡∏ö ${Math.abs(liquidity).toLocaleString('th-TH', {maximumFractionDigits: 0})} ‡∏ö‡∏≤‡∏ó ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏π‡∏á (${dti.toFixed(1)}% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ) ‡∏Ñ‡∏ß‡∏£‡∏•‡∏î‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å`;
        } else {
          liqAdvice = `‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏¥‡∏î‡∏•‡∏ö ${Math.abs(liquidity).toLocaleString('th-TH', {maximumFractionDigits: 0})} ‡∏ö‡∏≤‡∏ó ‡∏Ñ‡∏ß‡∏£‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 3 ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: `;
          if (top3.length > 0) {
            liqAdvice += top3.map((e, i) => `${i + 1}. ${e.label} (${e.value.toLocaleString('th-TH', {maximumFractionDigits: 0})} ‡∏ö‡∏≤‡∏ó)`).join(' ');
          }
        }
      } else {
        liqStatus = '‡∏î‡∏µ';
        liqColor = '#10b981';
        liqAdvice = `‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏î‡∏µ ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${liquidity.toLocaleString('th-TH', {maximumFractionDigits: 0})} ‡∏ö‡∏≤‡∏ó ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡∏≠‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï`;
      }

      // Store results for final summary
      userData.results = {
        dti: { value: dti, status: dtiStatus, color: dtiColor, advice: dtiAdvice },
        emergencyFund: { value: emergencyMonths, status: efStatus, color: efColor, advice: efAdvice },
        liquidity: { value: liquidity, status: liqStatus, color: liqColor, advice: liqAdvice }
      };

      // Go directly to attitude test
      startAttitudeTest();
    }

    let currentAttitudeQuestion = 0;

    function startAttitudeTest() {
      document.getElementById('questionScreen').classList.add('hidden');
      document.getElementById('attitudeScreen').classList.remove('hidden');
      document.getElementById('progressContainer').classList.remove('hidden');
      currentAttitudeQuestion = 0;
      userData.attitudeAnswers = [];
      showAttitudeQuestion();
    }

    function showAttitudeQuestion() {
      const attitudeContent = document.getElementById('attitudeContent');
      const question = attitudeQuestions[currentAttitudeQuestion];
      const progress = ((currentAttitudeQuestion + 1) / attitudeQuestions.length) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      document.getElementById('progressText').textContent = Math.round(progress) + '%';

      const optionsHtml = question.options.map((option, index) => `
        <button onclick="selectAttitudeAnswer(${index})" class="btn-modern w-full text-left px-6 py-5 bg-gradient-to-r from-gray-50 to-gray-100 rounded-2xl hover:from-purple-50 hover:to-indigo-50 border-2 border-gray-200 hover:border-purple-400 transition-all mb-3 font-semibold text-gray-800 shadow-sm hover:shadow-md">
          <span class="flex items-center gap-3">
            <span class="text-2xl">‚Ä¢</span>
            <span>${option.text}</span>
          </span>
        </button>
      `).join('');

      attitudeContent.innerHTML = `
        <div class="text-center mb-8">
          <div class="inline-block p-5 bg-gradient-to-br from-yellow-100 to-orange-100 rounded-2xl mb-5">
            <div class="text-5xl">ü§î</div>
          </div>
          <div class="inline-block px-4 py-2 bg-purple-100 rounded-full mb-4">
            <span class="text-sm font-bold text-purple-700">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà ${currentAttitudeQuestion + 1} / ${attitudeQuestions.length}</span>
          </div>
          <p class="text-xl text-gray-800 font-bold leading-relaxed max-w-lg mx-auto">${question.question}</p>
        </div>
        <div class="space-y-3">
          ${optionsHtml}
        </div>
      `;
    }

    function selectAttitudeAnswer(answerIndex) {
      const question = attitudeQuestions[currentAttitudeQuestion];
      const selectedOption = question.options[answerIndex];
      
      userData.attitudeAnswers.push({
        question: question.question,
        answer: selectedOption.text,
        correct: selectedOption.correct
      });

      // Show explanation
      const attitudeContent = document.getElementById('attitudeContent');
      const bgColor = selectedOption.correct ? '#d1fae5' : '#fee2e2';
      const borderColor = selectedOption.correct ? '#10b981' : '#ef4444';
      const textColor = selectedOption.correct ? '#065f46' : '#991b1b';
      const icon = selectedOption.correct ? '‚úÖ' : '‚ùå';

      attitudeContent.innerHTML = `
        <div class="text-center mb-8">
          <div class="inline-block p-6 rounded-3xl mb-5 shadow-xl" style="background: linear-gradient(135deg, ${bgColor}, ${bgColor});">
            <div class="text-6xl">${icon}</div>
          </div>
          <div class="inline-block px-4 py-2 bg-purple-100 rounded-full mb-4">
            <span class="text-sm font-bold text-purple-700">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà ${currentAttitudeQuestion + 1} / ${attitudeQuestions.length}</span>
          </div>
          <p class="text-lg text-gray-700 font-bold mb-6 max-w-lg mx-auto">${question.question}</p>
          <div class="p-5 rounded-2xl mb-6 shadow-lg" style="background-color: ${bgColor}; border: 3px solid ${borderColor};">
            <p class="font-bold text-lg" style="color: ${textColor};">‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ${selectedOption.text}</p>
          </div>
        </div>
        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6 mb-8 shadow-md">
          <div class="flex items-center gap-2 mb-3">
            <span class="text-2xl">üí°</span>
            <h3 class="font-bold text-lg text-blue-900">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</h3>
          </div>
          <p class="text-gray-700 leading-relaxed font-medium">${question.explanation}</p>
        </div>
        <button onclick="nextAttitudeQuestion()" class="btn-modern w-full px-6 py-5 text-white font-bold rounded-2xl shadow-xl text-lg" style="background: linear-gradient(135deg, ${defaultConfig.primary_color} 0%, ${defaultConfig.secondary_color} 100%);">
          ${currentAttitudeQuestion < attitudeQuestions.length - 1 ? '‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí' : '‡∏î‡∏π‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ üéØ'}
        </button>
      `;
    }

    function nextAttitudeQuestion() {
      currentAttitudeQuestion++;
      
      if (currentAttitudeQuestion < attitudeQuestions.length) {
        showAttitudeQuestion();
      } else {
        showFinalResults();
      }
    }

    function showFinalResults() {
      document.getElementById('attitudeScreen').classList.add('hidden');
      document.getElementById('progressContainer').classList.add('hidden');
      document.getElementById('finalScreen').classList.remove('hidden');

      const correctAnswers = userData.attitudeAnswers.filter(a => a.correct).length;
      const totalQuestions = attitudeQuestions.length;
      const score = (correctAnswers / totalQuestions) * 100;

      let attitudeLevel, attitudeColor, attitudeMessage;
      if (score >= 80) {
        attitudeLevel = '‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°';
        attitudeColor = '#10b981';
        attitudeMessage = '‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ó‡∏±‡∏®‡∏Ñ‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏°‡∏≤‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏°‡∏µ‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á';
      } else if (score >= 60) {
        attitudeLevel = '‡∏î‡∏µ';
        attitudeColor = '#3b82f6';
        attitudeMessage = '‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ó‡∏±‡∏®‡∏Ñ‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á';
      } else {
        attitudeLevel = '‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á';
        attitudeColor = '#f59e0b';
        attitudeMessage = '‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ó‡∏±‡∏®‡∏Ñ‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï';
      }

      const finalContent = document.getElementById('finalContent');
      finalContent.innerHTML = `
        <!-- Main Summary Header -->
        <div class="text-center mb-10">
          <div class="inline-block p-5 bg-gradient-to-br from-green-100 to-emerald-100 rounded-2xl mb-5">
            <div class="text-5xl">‚ú®</div>
          </div>
          <h3 class="text-3xl font-extrabold mb-3 gradient-text">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
          <p class="text-gray-500 font-medium">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏±‡∏®‡∏Ñ‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
        </div>

        <!-- Financial Health Section -->
        <div class="mb-8">
          <div class="flex items-center gap-3 mb-5">
            <div class="p-3 bg-gradient-to-br from-purple-100 to-indigo-100 rounded-xl">
              <span class="text-2xl">üìä</span>
            </div>
            <h3 class="text-2xl font-bold text-gray-800">‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h3>
          </div>
          
          <!-- DTI Card -->
          <div class="result-card bg-gradient-to-br from-white to-gray-50 border-l-4 rounded-2xl p-6 mb-4 shadow-lg" style="border-color: ${userData.results.dti.color};">
            <div class="flex items-center justify-between mb-4">
              <h4 class="text-lg font-bold text-gray-800">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏µ‡πâ‡∏ï‡πà‡∏≠‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (DTI)</h4>
              <span class="status-badge px-4 py-2 rounded-full text-white text-sm font-bold" style="background-color: ${userData.results.dti.color};">${userData.results.dti.status}</span>
            </div>
            <div class="text-4xl font-extrabold mb-3" style="color: ${userData.results.dti.color};">${userData.results.dti.value.toFixed(1)}%</div>
            <p class="text-gray-600 leading-relaxed font-medium">${userData.results.dti.advice}</p>
          </div>

          <!-- Emergency Fund Card -->
          <div class="result-card bg-gradient-to-br from-white to-gray-50 border-l-4 rounded-2xl p-6 mb-4 shadow-lg" style="border-color: ${userData.results.emergencyFund.color};">
            <div class="flex items-center justify-between mb-4">
              <h4 class="text-lg font-bold text-gray-800">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</h4>
              <span class="status-badge px-4 py-2 rounded-full text-white text-sm font-bold" style="background-color: ${userData.results.emergencyFund.color};">${userData.results.emergencyFund.status}</span>
            </div>
            <div class="text-4xl font-extrabold mb-3" style="color: ${userData.results.emergencyFund.color};">${userData.results.emergencyFund.value.toFixed(1)} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
            <p class="text-gray-600 leading-relaxed font-medium">${userData.results.emergencyFund.advice}</p>
          </div>

          <!-- Liquidity Card -->
          <div class="result-card bg-gradient-to-br from-white to-gray-50 border-l-4 rounded-2xl p-6 mb-4 shadow-lg" style="border-color: ${userData.results.liquidity.color};">
            <div class="flex items-center justify-between mb-4">
              <h4 class="text-lg font-bold text-gray-800">‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h4>
              <span class="status-badge px-4 py-2 rounded-full text-white text-sm font-bold" style="background-color: ${userData.results.liquidity.color};">${userData.results.liquidity.status}</span>
            </div>
            <div class="text-4xl font-extrabold mb-3" style="color: ${userData.results.liquidity.color};">${userData.results.liquidity.value.toLocaleString('th-TH', {maximumFractionDigits: 0})} ‡∏ø</div>
            <p class="text-gray-600 leading-relaxed font-medium">${userData.results.liquidity.advice}</p>
          </div>
        </div>

        <!-- Attitude Section -->
        <div class="mb-10">
          <div class="flex items-center gap-3 mb-5">
            <div class="p-3 bg-gradient-to-br from-yellow-100 to-orange-100 rounded-xl">
              <span class="text-2xl">üéØ</span>
            </div>
            <h3 class="text-2xl font-bold text-gray-800">‡∏ó‡∏±‡∏®‡∏Ñ‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h3>
          </div>
          
          <div class="result-card bg-gradient-to-br from-white to-gray-50 border-l-4 rounded-2xl p-8 shadow-lg" style="border-color: ${attitudeColor};">
            <div class="text-center">
              <div class="inline-block p-4 rounded-2xl mb-4" style="background: linear-gradient(135deg, ${attitudeColor}15, ${attitudeColor}25);">
                <div class="text-5xl">üéØ</div>
              </div>
              <h4 class="text-2xl font-bold mb-3" style="color: ${attitudeColor};">‡∏£‡∏∞‡∏î‡∏±‡∏ö: ${attitudeLevel}</h4>
              <div class="text-5xl font-extrabold mb-4" style="color: ${attitudeColor};">${correctAnswers}/${totalQuestions}</div>
              <p class="text-gray-600 leading-relaxed font-medium text-lg">${attitudeMessage}</p>
            </div>
          </div>
        </div>

        <!-- Action Button -->
        <button onclick="restartAssessment()" class="btn-modern w-full px-8 py-5 text-white font-bold rounded-2xl shadow-xl text-lg" style="background: linear-gradient(135deg, ${defaultConfig.primary_color} 0%, ${defaultConfig.secondary_color} 100%);">
          <span class="flex items-center justify-center gap-2">
            <span>üîÑ</span>
            <span>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà</span>
          </span>
        </button>
      `;
    }

    function restartAssessment() {
      currentStep = 0;
      currentAttitudeQuestion = 0;
      userData = {
        income: 0,
        debtExpense: 0,
        expenses: {},
        savings: 0,
        attitudeAnswers: []
      };
      
      document.getElementById('finalScreen').classList.add('hidden');
      document.getElementById('welcomeScreen').classList.remove('hidden');
      document.getElementById('progressContainer').classList.add('hidden');
      document.getElementById('progressBar').style.width = '0%';
    }

    // Element SDK Integration
    async function onConfigChange(config) {
      const mainTitle = document.getElementById('mainTitle');
      const subtitle = document.getElementById('subtitle');
      
      if (mainTitle) {
        mainTitle.textContent = config.main_title || defaultConfig.main_title;
        mainTitle.style.color = config.primary_color || defaultConfig.primary_color;
      }
      
      if (subtitle) {
        subtitle.textContent = config.subtitle || defaultConfig.subtitle;
      }
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [
          {
            get: () => config.primary_color || defaultConfig.primary_color,
            set: (value) => {
              config.primary_color = value;
              window.elementSdk.setConfig({ primary_color: value });
            }
          }
        ],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["main_title", config.main_title || defaultConfig.main_title],
        ["subtitle", config.subtitle || defaultConfig.subtitle]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99cbf906b2ab7b41',t:'MTc2Mjg0NTA1Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
